# bold9-test

## 1. 개요
- **BOLD9 Back-end team 채용 사전 과제**입니다.
- [Prisma](https://www.prisma.io/docs/), TypeScript, apollo-server, mysql을 사용합니다.
- 간단한 회원 등록, 게시글 및 댓글 등록 기능이 있습니다.

### 1) 엔티티 간 관계도

![[Pasted image 20240202120332.png]]

## 2. setting
### 1) git clone
```
git clone https://github.com/rimgosu/bold9-test.git
```

### 2) docker 설치
- getting started : [https://www.docker.com/get-started/](https://www.docker.com/get-started/)
- ubuntu docker 설치 : [https://docs.docker.com/engine/install/ubuntu/](https://docs.docker.com/engine/install/ubuntu/)
- windows docker desktop 설치 : <https://www.docker.com/products/docker-desktop/>


### 3) docker-compse로 실행
- 먼저 터미널을 bold9-test 루트 경로로 이동합니다.
```
cd path/to/bold9-test
```

- docker-compose를 실행합니다.
```
docker-compose up
```

### 4) 마이그레이션, 시드 불러오기
- 다른 터미널을 실행하고, 마찬가지로 bold9-test 루트 경로로 이동합니다.
```
cd path/to/bold9-test
```

- prisma 스키마를 마이그레이션하고, 시드를 불러옵니다.
```
docker-compose exec app npx prisma migrate deploy
docker-compose exec app npx prisma db seed 
```

### 5) 접속
-  http://localhost:4000/
- GUI: https://studio.apollographql.com/sandbox/explorer
	- SANDBOX: http://localhost:4000/

## 3. 쿼리 예제
- <https://studio.apollographql.com/sandbox/explorer> 환경에서 쿼리를 실행하는 것을 추천합니다.



### 1) userPostsAndComments
- post content에 `graphql` 문자열이 포함된 항목을 찾습니다.
```
query {
  userPostsAndComments(userId: 1) {
    id
    title
    content
    comments {
      id
      content
    }
  }
}
```

### 2) createUser
- 유저를 생성합니다.
- email: 반드시 이메일 형식이어야 합니다.
```
mutation {
  createUser(email: "example@example.com", password: "password123", name: "John Doe") {
    id
    email
    name
  }
}

```

### 3) createPost
- 게시글을 생성합니다.
- title, content가 빈 값이면 안됩니다.
- authorId는 이미 생성된 user의 id를 적어야합니다.
```
mutation {
  createPost(title: "My First Post", content: "This is the content of my first post. graphql", published: true, authorId: "1") {
    id
    title
    content
    published
    author {
      id
      name
    }
  }
}
```


### 4) createComment
- 댓글을 성합니다.
- content 항목이 빈 값이면 안됩니다.
- postId는 이미 생성된 post의 id를 적어야합니다.
```
mutation {
  createComment(content: "This is a comment.", postId: "1") {
    id
    content
    post {
      id
      title
    }
  }
}
```



## 4. 테스트

### 1) 테스트 실행
```
docker-compose exec app npm test
```

### 2) 테스트 항목
1. createUser 기능 테스트
2. createUser 이메일 유효성 검사
3. createUser 이메일 중복 검사 진행
4. 게시물 생성 테스트
5. 유효하지 않은 제목, 내용 테스트
6. 유효하지 않은 authorId로 인한 게시물 생성 실패 테스트
7. 유효한 입력으로 댓글 생성 시, 올바른 속성을 가진 객체가 생성되는지 테스트
8. 유효하지 않은 content로 댓글을 생성하려 할 때, 오류가 발생하는지 테스트
9. 유효하지 않은 postId로 댓글을 생성하려 할 때, 오류가 발생하는지 테스트
10. userPostsAndComments 기능 확인
11. graphql 문자열을 포함하고 있는 content가 있을 때 기능 테스트
12. graphql 문자열을 포함하고 있는 content가 없을 때 기능 테스트
